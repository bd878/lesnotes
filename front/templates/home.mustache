<div id="content" class="h-full flex flex-col">
	<div id="sidebar" class="flex flex-row justify-between w-full max-w-5xl mb-4">
		<div class="flex flex-row">
			<a class="italic text-2xl mr-4 inline-block cursor-pointer underline hover:text-blue-600" href="/home" target="_self">Les Notes</a>
		</div>

		<a href="/logout" target="_self" class="underline text-blue-600 visited:text-purple-600">{{logout}}</a>
	</div>

	<div class="flex flex-row w-full grow mb-4 max-w-5xl">
		<div id="editor" class="mr-2 max-w-xl flex flex-col grow-2">
			{{#message}}
				{{#editMessage}}
					{{#private}}
						<div class="italic text-sm text-gray-600 mb-2">#{{ID}}</div>
					{{/private}}
					{{^private}}
						<div class="italic text-sm text-gray-600">#{{ID}}</div>
						<a class="italic text-blue-600 text-sm" href="/m/{{userID}}/{{ID}}" target="_blank">https://{{domain}}/m/{{userID}}/{{ID}}</a>
					{{/private}}

					<form data-message-id="{{ID}}" id="message-edit-form" name="message-edit-form" autocomplete="off" onsubmit="return false;" class="w-full flex flex-col grow">
						<div class="flex flex-col grow">
							{{^private}}
								<div class="inline text-sm mr-1 italic text-gray-600">/m/<input name="messageName" class="mb-2 focus:outline-none resize-none text-sm" placeholder="{{namePlaceholder}}" value="{{name}}"></input></div>
							{{/private}}
							<input name="messageTitle" class="focus:outline-none w-full resize-none italic text-gray-600 text-lg" placeholder="{{titlePlaceholder}}" value="{{title}}"></input>
							<textarea name="messageText" type="input" class="focus:outline-none w-full resize-none italic text-gray-600 text-sm h-full" placeholder="{{textPlaceholder}}">{{text}}</textarea>
						</div>

						<div class="flex flex-col">
							<div></div>
							<div class="flex flex-row justify-between">
								<button data-message-id="{{ID}}" type="submit" class="border-1 px-4 border-solid text-left cursor-pointer">{{update}}</button>
								<button id="message-cancel-edit" class="border-1 px-4 border-solid text-left cursor-pointer">{{cancel}}</button>
							</div>
						</div>
					</form>
				{{/editMessage}}
				{{^editMessage}}
					{{#private}}
						<div class="italic text-sm text-gray-600 mb-2">#{{ID}}</div>
					{{/private}}
					{{^private}}
						<div class="italic text-sm text-gray-600">#{{ID}}</div>
						<a class="italic text-blue-600 text-sm mb-2" href="/m/{{userID}}/{{ID}}" target="_blank">https://{{domain}}/m/{{userID}}/{{ID}}</a>
					{{/private}}

					<div id="message" class="flex flex-col justify-between grow">
						<div>
							{{#title}}
								<div class="whitespace-pre-wrap text-lg">{{title}}</div>
							{{/title}}
							<p class="whitespace-pre-wrap">{{text}}</p>
						</div>

						<div class="flex flex-row">
							<button id="message-delete" data-message-id="{{ID}}" type="button" class="border-1 px-4 border-solid text-left cursor-pointer mr-2">{{delete}}</button>
							<button id="message-edit" data-message-id="{{ID}}" type="button" class="border-1 px-4 border-solid text-left cursor-pointer mr-2">{{edit}}</button>
							{{#private}}
								<button id="message-publish" data-message-id="{{ID}}" type="button" class="border-1 px-4 border-solid text-left cursor-pointer mr-2">{{publish}}</button>
							{{/private}}
							{{^private}}
								<button id="message-private" data-message-id="{{ID}}" type="button" class="border-1 px-4 border-solid text-left cursor-pointer mr-2">{{privateText}}</button>
							{{/private}}
							<button id="message-cancel" type="button" class="border-1 px-4 border-solid text-left cursor-pointer">{{cancel}}</button>
						</div>
					</div>
				{{/editMessage}}
			{{/message}}
			{{^message}}
				<form id="message-form" name="message-form" autocomplete="off" onsubmit="return false;" class="w-full flex flex-row grow">
					<div class="flex flex-col mr-4 mt-4">
						<button type="submit" class="cursor-pointer">
							<svg fill="#000000" width="24px" height="24px" viewBox="0 0 1920 1920" xmlns="http://www.w3.org/2000/svg">
							    <path d="M960 1807.059c-467.125 0-847.059-379.934-847.059-847.059 0-467.125 379.934-847.059 847.059-847.059 467.125 0 847.059 379.934 847.059 847.059 0 467.125-379.934 847.059-847.059 847.059M960 0C430.645 0 0 430.645 0 960s430.645 960 960 960 960-430.645 960-960S1489.355 0 960 0M854.344 1157.975 583.059 886.69l-79.85 79.85 351.135 351.133L1454.4 717.617l-79.85-79.85-520.206 520.208Z" fill-rule="evenodd"/>
							</svg>
						</button>
					</div>

					<div class="flex flex-col grow">
						<input name="messageTitle" class="focus:outline-none w-full resize-none italic text-gray-600 text-lg mb-2" placeholder="{{titlePlaceholder}}"></input>
						<textarea name="messageText" type="input" class="focus:outline-none w-full resize-none italic text-gray-600 text-sm h-full" placeholder="{{textPlaceholder}}"></textarea>
					</div>
				</form>
			{{/message}}
		</div>

		<div id="files" class="p-2 ml-2 max-w-md flex flex-col border-1 border-solid grow-1">
			{{#message}}
				<p class="text-xl mb-2">{{filesPlaceholder}}</p>

				<ul class="flex flex-col">
					{{#files}}
						<li class="grow-1 max-w-full flex flex-row justify-between whitespace-nowrap">
							<a target="_blank" href="/files/v1/{{ID}}/download" class="flex flex-row justify-between overflow-hidden cursor-pointer">{{name}}</a>
						</li>
					{{/files}}
					{{^files}}
						{{^editMessage}}
							<li class="text-gray-600 italic">{{noFiles}}</li>
						{{/editMessage}}
					{{/files}}
				</ul>

				{{#editMessage}}
					<form id="file-form" name="file-form" autocomplete="off" onsubmit="return false;" class="flex flex-row">
						<input id="files-input" class="hidden" type="file" multiple></input>
						<button id="select-files-button" type="button" class="border-1 px-4 border-solid text-left cursor-pointer">{{selectFiles}}</button>
					</form>
				{{/editMessage}}
			{{/message}}
			{{^message}}
				<p class="text-xl mb-2">{{filesPlaceholder}}</p>

				<form id="file-form" name="file-form" autocomplete="off" onsubmit="return false;" class="flex flex-row">
					<input id="files-input" type="file" class="hidden" multiple></input>
					<button id="select-files-button" type="button" class="border-1 px-4 border-solid text-left cursor-pointer">{{selectFiles}}</button>
				</form>
			{{/message}}
		</div>
	</div>

	<div id="messages" class="pr-2 flex flex-col w-md min-w-md">
		<div class="flex flex-col w-full">
			{{#error}}
				<span>{{.}}</span>
			{{/error}}
			{{^error}}
				<div id="threads-list">
					<ul class="flex flex-row mb-2">
						{{#threads}}
							<li class="flex before:content-['/'] flex-row justify-between">
								<button class="overflow-hidden whitespace-nowrap justify-between flex flex-row w-full" data-message-id="{{ID}}">
									<div class="hover:text-blue-600 whitespace-nowrap cursor-pointer overflow-hidden text-ellipsis mr-2" data-message-id="{{ID}}">
										{{#title}}
											{{title}}
										{{/title}}
										{{^title}}
											{{text}}
										{{/title}}
									</div>

									<div data-message-id="{{ID}}" class="italic">{ {{count}} }</div>
								</button>
							</li>
						{{/threads}}
					</ul>
				</div>

				<div id="messages-list">
					<ul class="flex flex-col">
						{{#messages}}
							<li class="mb-2 grow-1 max-w-full flex flex-row justify-between whitespace-nowrap">
								<button type="button" class="flex flex-row justify-between overflow-hidden bg-gray-300 hover:bg-gray-500 hover:text-white cursor-pointer text-left px-2 italic w-full" data-message-id="{{ID}}">
									<div class="overflow-hidden text-ellipsis mr-2" data-message-id="{{ID}}">
										{{#title}}
											{{title}}
										{{/title}}
										{{^title}}
											{{text}}
										{{/title}}
									</div>

									<div data-message-id="{{ID}}">{{count}}</div>
								</button>

								<button type="button" class="bg-gray-300 hover:bg-gray-500 hover:text-white cursor-pointer px-2 ml-2" data-thread-id="{{ID}}"> > </button>
							</li>
						{{/messages}}
						{{^messages}}
							{{^message}}
								<li class="text-gray-600 italic">{{newMessageText}}</li>
							{{/message}}
						{{/messages}}
					</ul>
				</div>
			{{/error}}
		</div>
	</div>

	<div id="search">
		<input class="italic px-1 text-gray-600 border border-black" type="text" id="search" name="search" placeholder="{{search}}"></input>
	</div>
</div>