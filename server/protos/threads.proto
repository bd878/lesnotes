syntax = "proto3";

package threads.v1;

import "protos/distributed.proto";

option go_package = "github.com/bd878/gallery/server/api";

service Threads {
	rpc Resolve(ResolveRequest) returns (ResolveResponse) {}
	rpc Publish(PublishRequest) returns (PublishResponse) {}
	rpc Private(PrivateRequest) returns (PrivateResponse) {}
	rpc Reorder(ReorderRequest) returns (ReorderResponse) {}
	rpc Update(UpdateRequest) returns (UpdateResponse) {}
	rpc Create(CreateRequest) returns (CreateResponse) {}
	rpc Delete(DeleteRequest) returns (DeleteResponse) {}
	rpc GetServers(GetServersRequest) returns (GetServersResponse) {}
}

message Thread {
	int64    id = 1;
	string   name = 2;
	bool     private = 3;
	int64    user_id = 4;
	int64    parent_id = 5;
	int64    next_id = 6;
	int64    prev_id = 7;
}

message PublishRequest {
	int64 id = 1;
	int64 user_id = 2;
}

message PublishResponse {
}

message PrivateRequest {
	int64 id = 1;
	int64 user_id = 2;
}

message PrivateResponse {
}

message UpdateRequest {
	int64     id = 1;
	int64     user_id = 2;
	string    name = 3;
	int32     private = 4;
}

message UpdateResponse {}

message ReorderRequest {
	int64     id = 1;
	int64     user_id = 2;
	int64     next_id = 3;
	int64     prev_id = 4;
	int64     parent_id = 5;
}

message ReorderResponse {}

message CreateRequest {
	int64     id = 1;
	int64     user_id = 2;
	int64     parent_id = 3;
	string    name = 4;
	bool      private = 5;
	int64     next_id = 6;
	int64     prev_id = 7;
}

message CreateResponse {
}

message DeleteRequest {
	int64     id = 1;
	int64     user_id = 2;
}

message DeleteResponse {
}

message ResolveRequest {
	int64     id = 1;
	int64     user_id = 2;
}

message ResolveResponse {
	repeated int64 path = 1;
}